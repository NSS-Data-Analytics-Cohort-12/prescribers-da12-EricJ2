1.a. Which prescriber had the highest total number of claims (totaled over all drugs)? Report the npi and the total number of claims.

select prescription.total_claim_count, prescription.npi, prescriber.nppes_provider_last_org_name as last_name, prescriber.nppes_provider_first_name as first_name
from prescription
left join prescriber
	on prescriber.npi = prescription.npi
order by total_claim_count desc

= 4538	1912011792	"COFFEY"	"DAVID"
3655	1881634483	"PENDLEY"	"BRUCE"
3531	1881634483	"PENDLEY"	"BRUCE"

b. 
select prescription.total_claim_count, prescription.npi, prescriber.nppes_provider_last_org_name as last_name, prescriber.nppes_provider_first_name as first_name,
		prescriber.specialty_description
from prescription
left join prescriber
	on prescriber.npi = prescription.npi
order by total_claim_count desc

2.a.
QUESTION MATERIAL: wrong:
select sum(prescription.total_claim_count) as total_claims, prescriber.specialty_description
from prescription
left join prescriber
	on prescriber.npi= prescription.npi
group by prescription.total_claim_count, prescriber.specialty_description
order by prescription.total_claim_count desc
limit 1;

correct with join, inner join, and right join:
select prescriber.specialty_description, sum(prescription.total_claim_count) as total_claims
from prescriber
right join prescription on prescriber.npi = prescription.npi
group by prescriber.specialty_description
order by total_claims desc
LIMIT 1;

3.a. ?
3.b. C1 Esterase Inhibitor- $3495.22
SELECT d.generic_name, SUM(pr.total_drug_cost) / SUM(pr.total_day_supply) AS total_cost_per_day
FROM prescription pr
JOIN drug d ON pr.drug_name = d.drug_name
GROUP BY d.generic_name
ORDER BY total_cost_per_day DESC
LIMIT 1;